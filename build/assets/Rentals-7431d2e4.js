import"./base-40151e19.js";import{E as J,a as K}from "./el-table-column-d728468a.js";import"./el-checkbox-8f2d8563.js";import"./el-tooltip-fe7a3ae3.js";import"./el-scrollbar-4d76fa87.js";import{E as Q}from "./el-button-7a3e83ea.js";/* empty css               */import{E as W}from "./el-date-picker-570f40ab.js";import{E as X}from "./el-input-5a2c3fae.js";/* empty css                  */import{r as a,k as Z,o as ee,a as n,c as m,b as o,d as s,y as q,F as $,m as D,i as R,l as u,j as g,t as b,u as E,C as le,q as x,s as ae}from "./app-417fc4a4.js";import{m as L}from "./moment-8f0dca05.js";import{L as te}from "./Loader-c820d086.js";import{E as oe,a as se}from "./index-7afdeace.js";import"./objects-a3f7d715.js";import"./_initCloneObject-5d6a36d4.js";import"./isArrayLikeObject-38992b29.js";import"./_baseIteratee-ab40514f.js";import"./flatten-66fc93b5.js";import"./index-e7076969.js";import"./use-global-config-2834e396.js";import"./typescript-8048a034.js";/* empty css                                                               */import"./_plugin-vue_export-helper-c27b6911.js";import"./scroll-b0cd01fe.js";import"./validator-3cef17f7.js";const re={class:"card"},ne={key:0,class:"modal-mask"},de={key:0},ie={key:1,class:"modal-container",ref:"target"},ue={class:"modal-header"},ce={class:"modal-body overflow-y-auto",style:{"max-height":"calc(100vh - 210px)"}},me=o("h2",null,"Customer Feedback",-1),ve=["item-key"],pe={class:"row col-md-12"},_e={class:"col-md-6 text-nowrap"},fe={class:"col-md-6 text-nowrap"},be={class:"modal-footer"},ge={class:"card-body"},ye={class:"row"},he={class:"formbold-mb-3 col-md-2"},we=o("label",{class:"formbold-form-label"},"Country",-1),ke={class:"formbold-mb-3 col-md-2"},Ce=o("label",{class:"formbold-form-label"},"Status",-1),xe={class:"formbold-mb-3 col-md-2"},Ve=o("label",{class:"formbold-form-label"},"Rental Reference",-1),$e={class:"col-md-3 date-input"},De={class:""},Re=o("label",{class:"formbold-form-label"},"Select Date Range",-1),Ee=o("h2",{class:"mb-4"},"Rentals",-1),Se={class:"d-flex"},Ye=["onClick"],sl={__name:"Rentals",setup(Be){const w=a(""),k=a([]),d=a(!1),S=a(""),v=a("");a(""),a("");const p=a(""),_=a(""),V=a(!1),c={loading:a(!1),all:a([]),list:a([]),options:a([])};a(!1),a([]),a([]),a([]),a(!1),a([]),a([]),a([]);const Y=a({}),y={loading:a(!1),all:a([]),list:a([]),options:a([])},N=async t=>{try{d.value=!0;const l=await axios.get("/rental/rate/"+t,{});console.log(l),l.data.status&&(V.value=!0,Y.value=l.data.data),d.value=!1}catch{d.value=!1}},U=()=>{V.value=!1},A=async()=>{c.loading.value=!0;try{const t=await axios.get("/get/countries",{});c.all.value=t.data,console.log(t),c.list.value=c.all.value.map(l=>({id:`${l}`,label:`${l}`,iso:`${l}`}))}catch(t){console.error(t)}finally{c.loading.value=!1}},f=a(""),F=async()=>{try{const t=await axios.get("/get/user/role");S.value=t.data}catch(t){console.error(t)}},O=()=>{h()},h=async()=>{try{d.value=!0;const t={country:"",order_status:"",order_number:"",date_range:""};(v.value!==[]||v.value!=null||v.value!==void 0||v.value!=="")&&(t.country=v.value),(f.value!==[]||f.value!=null||f.value!==void 0||f.value!=="")&&(t.order_status=f.value),(p.value!==[]||p.value!=null||p.value!==void 0||p.value!=="")&&(t.order_number=p.value),(_.value!==[]||_.value!=null||_.value!==void 0||_.value!=="")&&(t.date_range=_.value),console.log(t);const l=await axios.get("/get/rentals",{params:t});k.value=l.data.rentals,y.all.value=l.data.rental_statuses,y.list.value=y.all.value.map(r=>({value:`${r.name_en}`,label:`${r.name_en}`,id:`${r.id}`})),y.loading.value=!1}catch(t){console.error(t)}finally{d.value=!1}},P=Z(()=>k.value.filter(t=>!w.value||t.vehicle.name.toLowerCase().includes(w.value.toLowerCase()))),j=async(t, l)=>{try{d.value=!0;const r=await axios.post("accept/rentals",l);k.value=r.data}catch(r){console.error(r)}finally{d.value=!1}},I=async(t, l)=>{try{d.value=!0;const r=await axios.post("delete/rentals",l);k.value=r.data}catch(r){console.error(r)}finally{d.value=!1}};return ee(()=>{F(),h(),A()}),(t, l)=>{var M;const r=se,B=oe,T=X,G=W,i=K,z=Q,H=J;return n(),m("div",re,[V.value?(n(),m("div",ne,[o("div",{class:"modal-wrapper",onClick:l[1]||(l[1]= e=>t.$emit("close"))},[d.value?(n(),m("div",de,[s(te)])):(n(),m("div",ie,[o("div",ue,[q(t.$slots,"header",{},()=>[g(" Rental Review")])]),o("div",ce,[me,(n(!0),m($,null,D((M=Y.value)==null?void 0:M.rental_rates,(e, C)=>(n(),m("div",{"item-key":C},[o("div",pe,[o("div",_e,b(e.question.objective),1),o("div",fe,[s(E(le),{style:{"border-radius":"10px"},value:e.rate*10},{default:u(()=>[g(b(e.rate)+" / 10",1)]),_:2},1032,["value"])])])],8,ve))),256))]),o("div",be,[q(t.$slots,"footer",{},()=>[o("div",null,[o("button",{class:"btn btn-primary",onClick:l[0]||(l[0]= e=>U())},"Done")])])])],512))])])):R("",!0),o("div",ge,[o("div",ye,[o("div",he,[we,s(B,{modelValue:v.value,"onUpdate:modelValue":l[2]||(l[2]= e=>v.value=e),size:"large",filterable:"",remote:"","reserve-keyword":"",placeholder:"Countries...","remote-show-suffix":"",loading:c.loading.value,onChange:l[3]||(l[3]= e=>h()),required:""},{default:u(()=>[(n(!0),m($,null,D(c.list.value, e=>(n(),x(r,{key:e.id,label:e.label,value:e.label},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),o("div",ke,[Ce,s(B,{modelValue:f.value,"onUpdate:modelValue":l[4]||(l[4]= e=>f.value=e),size:"large",filterable:"",remote:"","reserve-keyword":"",placeholder:"Rental Status...","remote-show-suffix":"",style:{height:"35px"},loading:c.loading.value,onChange:l[5]||(l[5]= e=>O()),required:""},{default:u(()=>[(n(!0),m($,null,D(y.all.value, e=>(n(),x(r,{key:e.id,label:e.name_en,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),o("div",xe,[Ve,s(T,{placeholder:"Reference...",modelValue:p.value,"onUpdate:modelValue":l[6]||(l[6]= e=>p.value=e),onChange:l[7]||(l[7]= e=>h()),style:{height:"35px"}},null,8,["modelValue"])]),o("div",$e,[o("div",De,[Re,s(G,{modelValue:_.value,"onUpdate:modelValue":l[8]||(l[8]= e=>_.value=e),type:"daterange","range-separator":"TO","start-placeholder":"Start date","end-placeholder":"End date",size:"large",required:"true",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD",style:{height:"35px"},onChange:h},null,8,["modelValue"])])])]),Ee,o("div",Se,[s(H,{data:P.value,style:{width:"100%"},loading:d.value,stripe:""},{default:u(()=>[s(i,{label:"Booking Reference",prop:"order_number"}),s(i,{label:"Vehicle",prop:"vehicle.name"}),s(i,{label:"Customer Name",prop:"customer.name"}),s(i,{label:"Country",prop:"customer.country"}),s(i,{label:"Total Price",prop:"supplier_price"},{default:u(e=>[g(b(e.row.price)+" "+b(e.row.currency),1)]),_:1}),s(i,{label:"Rental Status",prop:"status.name_en"}),s(i,{label:"Started At",prop:"start_date"}),s(i,{label:"Ended At",prop:"end_date"}),s(i,{label:"Duration",align:"center",prop:"start_date"},{default:u(e=>[g(b(E(L)(e.row.end_date).diff(E(L)(e.row.start_date),"days")),1)]),_:1}),s(i,{label:"Review",align:"center",prop:"rate"},{default:u(e=>[o("a",{onClick: C=>N(e.row.id),href:"#"},b(e.row.rate),9,Ye)]),_:1}),s(i,{align:"right"},ae({header:u(()=>[s(T,{modelValue:w.value,"onUpdate:modelValue":l[9]||(l[9]= e=>w.value=e),size:"small",placeholder:"Type to search"},null,8,["modelValue"])]),_:2},[S.value==="active_supplier"?{name:"default",fn:u(e=>[e.row.order_status===0?(n(),x(z,{key:0,size:"small",type:"success",onClick: C=>j(e.$index,e.row)},{default:u(()=>[g("Activate ")]),_:2},1032,["onClick"])):R("",!0),e.row.order_status===0||e.row.order_status===1?(n(),x(z,{key:1,size:"small",type:"danger",onClick: C=>I(e.$index,e.row)},{default:u(()=>[g(b(e.row.order_status===0?"Delete":e.row.order_status===1?"Disable":""),1)]),_:2},1032,["onClick"])):R("",!0)]),key:"0"}:void 0]),1024)]),_:1},8,["data","loading"])])])])}}};export{sl as default};
