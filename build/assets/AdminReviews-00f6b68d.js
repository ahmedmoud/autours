import"./base-40151e19.js";import{E as Z,a as ee}from "./el-table-column-d728468a.js";import"./el-checkbox-8f2d8563.js";import"./el-tooltip-fe7a3ae3.js";import"./el-scrollbar-4d76fa87.js";/* empty css               */import{E as le}from "./el-date-picker-570f40ab.js";import{E as ae}from "./el-input-5a2c3fae.js";import"./el-button-7a3e83ea.js";/* empty css                  */import{r as o,k as oe,o as te,x as se,a as r,c as n,b as t,d as s,y as M,F as V,m as $,l as u,i as z,j as k,t as x,u as D,C as re,q as T}from "./app-417fc4a4.js";import{d as ne}from "./index-5c14bedf.js";/* empty css                    */import{h as P}from "./moment-a9aaa855.js";import{L as ie}from "./Loader-c820d086.js";import{E as de,a as ue}from "./index-7afdeace.js";import"./objects-a3f7d715.js";import"./_initCloneObject-5d6a36d4.js";import"./isArrayLikeObject-38992b29.js";import"./_baseIteratee-ab40514f.js";import"./flatten-66fc93b5.js";import"./typescript-8048a034.js";import"./index-e7076969.js";import"./use-global-config-2834e396.js";/* empty css                                                               */import"./_plugin-vue_export-helper-c27b6911.js";import"./scroll-b0cd01fe.js";import"./validator-3cef17f7.js";const ce={class:"card"},me={key:0,class:"modal-mask"},ve={key:0},pe={key:1,class:"modal-container",ref:"target"},_e={class:"modal-header"},fe={class:"modal-body overflow-y-auto",style:{"max-height":"calc(100vh - 210px)"}},ge=t("h2",null,"Customer Feedback",-1),be=["item-key"],he={class:"row col-md-12"},ye={class:"col-md-6 text-nowrap"},we={class:"col-md-6 text-nowrap"},ke={key:0,class:"mt-5 ml-2"},xe=t("label",null,"Comment",-1),Ce={class:"modal-footer"},Ve={class:"card-body"},$e={class:"row"},Re={class:"formbold-mb-3 col-md-2"},Se=t("label",{class:"formbold-form-label"},"Country",-1),Ee={class:"formbold-mb-3 col-md-2"},De=t("label",{class:"formbold-form-label"},"Suppliers",-1),Te={class:"formbold-mb-3 col-md-2"},Le=t("label",{class:"formbold-form-label"},"Status",-1),Ye={class:"formbold-mb-3 col-md-2"},Ue=t("label",{class:"formbold-form-label"},"Rental Reference",-1),qe={class:"col-md-3 date-input"},Be={class:""},Me=t("label",{class:"formbold-form-label"},"Select Date Range",-1),ze=t("h2",{class:"mb-4"},"Rentals",-1),Pe={class:"d-flex"},Ae=["onClick"],Ne=t("i",{class:"fa fa-star"},null,-1),gl={__name:"AdminReviews",setup(Fe){const i=o(""),c=o("");o("");const p=o(""),_=o(""),m={loading:o(!1),all:o([]),list:o([]),options:o([])},f={loading:o(!1),all:o([]),list:o([]),options:o([])};o(!1),o([]),o([]),o([]);const b={loading:o(!1),all:o([]),list:o([]),options:o([])},v=o(""),h=o(""),L=o([]),g=o(!1),A=o(""),N=o({});ne.useToast();const R=o(!1),C=o({}),F=()=>{R.value=!1},O=async a=>{try{g.value=!0;const e=await axios.get("/rental/rate/"+a,{});console.log(e),e.data.status&&(R.value=!0,C.value=e.data.data),g.value=!1}catch{g.value=!1}},j=async()=>{m.loading.value=!0;try{const a=await axios.get("/get/countries",{});m.all.value=a.data,console.log(a),m.list.value=m.all.value.map(e=>({id:`${e}`,label:`${e}`,iso:`${e}`}))}catch(a){console.error(a)}finally{m.loading.value=!1}},I=async()=>{try{if(f.loading.value=!0,i.value){const a=await axios.get("/get/suppliers",{params:{country:i.value}});f.all.value=a.data,f.list.value=f.all.value.map(e=>({value:`${e.name}`,label:`${e.name}`,id:`${e.id}`}))}}catch(a){console.error(a)}finally{f.loading.value=!1}},G=()=>{y()},H=async()=>{try{const a=await axios.get("/get/supplier/invoice",{params:{company_id:c.value}});N.value=a.data.data,y()}catch(a){console.error(a)}},J=async()=>{try{const a=await axios.get("/get/user/role");A.value=a.data}catch(a){console.error(a)}},y=async()=>{try{g.value=!0;const a={country:"",supplier_id:"",order_status:"",order_number:"",date_range:"",has_review:1};(i.value!==[]||i.value!=null||i.value!==void 0||i.value!=="")&&(a.country=i.value),(c.value!==[]||c.value!=null||c.value!==void 0||c.value!=="")&&(a.supplier_id=c.value),(v.value!==[]||v.value!=null||v.value!==void 0||v.value!=="")&&(a.order_status=v.value),(p.value!==[]||p.value!=null||p.value!==void 0||p.value!=="")&&(a.order_number=p.value),(_.value!==[]||_.value!=null||_.value!==void 0||_.value!=="")&&(a.date_range=_.value);const e=await axios.get("/get/rentals/admin",{params:a});L.value=e.data.rentals,b.all.value=e.data.rental_statuses,b.list.value=b.all.value.map(w=>({value:`${w.name_en}`,label:`${w.name_en}`,id:`${w.id}`})),b.loading.value=!1}catch(a){console.error(a)}finally{g.value=!1}},K=oe(()=>L.value.filter(a=>!h.value||a.vehicle.name.toLowerCase().includes(h.value.toLowerCase())||a.order_number.toLowerCase().includes(h.value.toLowerCase()))),Q=async()=>{let a=new URLSearchParams(window.location.search);a.has("status")&&(v.value=a.get("status"))};return te(()=>{Q(),J(),y(),j()}),(a, e)=>{var U,q;const w=se("Textarea"),S=ue,E=de,Y=ae,W=le,d=ee,X=Z;return r(),n("div",ce,[R.value?(r(),n("div",me,[t("div",{class:"modal-wrapper",onClick:e[1]||(e[1]= l=>a.$emit("close"))},[g.value?(r(),n("div",ve,[s(ie)])):(r(),n("div",pe,[t("div",_e,[M(a.$slots,"header",{},()=>[k(" Rental Review")])]),t("div",fe,[ge,(r(!0),n(V,null,$((U=C.value)==null?void 0:U.rental_rates,(l, B)=>(r(),n("div",{"item-key":B},[t("div",he,[t("div",ye,x(l.question.objective),1),t("div",we,[s(D(re),{style:{"border-radius":"10px"},value:l.rate*10},{default:u(()=>[k(x(l.rate)+" / 10",1)]),_:2},1032,["value"])])])],8,be))),256)),(q=C.value)!=null&&q.comment?(r(),n("div",ke,[xe,s(w,{class:"col-md-12",disabled:"",rows:"5"},{default:u(()=>[k(" "+x(C.value.comment)+" ",1)]),_:1})])):z("",!0)]),t("div",Ce,[M(a.$slots,"footer",{},()=>[t("div",null,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]= l=>F())},"Done")])])])],512))])])):z("",!0),t("div",Ve,[t("div",$e,[t("div",Re,[Se,s(E,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]= l=>i.value=l),size:"large",filterable:"",remote:"","reserve-keyword":"",placeholder:"Countries...","remote-show-suffix":"",loading:m.loading.value,onChange:e[3]||(e[3]= l=>I()),required:""},{default:u(()=>[(r(!0),n(V,null,$(m.list.value, l=>(r(),T(S,{key:l.id,label:l.label,value:l.label},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),t("div",Ee,[De,s(E,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]= l=>c.value=l),size:"large",filterable:"",remote:"",style:{height:"35px"},"reserve-keyword":"",onChange:e[5]||(e[5]= l=>H()),placeholder:"Suppliers...","remote-show-suffix":"",loading:f.loading.value,required:""},{default:u(()=>[(r(!0),n(V,null,$(f.list.value, l=>(r(),T(S,{key:l.id,label:l.label,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),t("div",Te,[Le,s(E,{modelValue:v.value,"onUpdate:modelValue":e[6]||(e[6]= l=>v.value=l),size:"large",filterable:"",remote:"","reserve-keyword":"",placeholder:"Rental Status...","remote-show-suffix":"",style:{height:"35px"},loading:m.loading.value,onChange:e[7]||(e[7]= l=>G()),required:""},{default:u(()=>[(r(!0),n(V,null,$(b.all.value, l=>(r(),T(S,{key:l.id,label:l.name_en,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),t("div",Ye,[Ue,s(Y,{placeholder:"Reference...",modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]= l=>p.value=l),onChange:e[9]||(e[9]= l=>y()),style:{height:"35px"}},null,8,["modelValue"])]),t("div",qe,[t("div",Be,[Me,s(W,{modelValue:_.value,"onUpdate:modelValue":e[10]||(e[10]= l=>_.value=l),type:"daterange","range-separator":"TO","start-placeholder":"Start date","end-placeholder":"End date",size:"large",required:"true",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD",style:{height:"35px"},onChange:y},null,8,["modelValue"])])])]),ze,t("div",Pe,[s(X,{data:K.value,style:{width:"100%"},loading:g.value,stripe:""},{default:u(()=>[s(d,{align:"left",label:"Booking #",prop:"order_number"}),s(d,{align:"left",label:"Vehicle",prop:"vehicle.name"}),s(d,{align:"left",label:"Country",prop:"customer.country"}),s(d,{align:"left",label:"Supplier name",prop:"vehicle.supplier.name"}),s(d,{align:"left",label:"Started At",prop:"start_date"}),s(d,{align:"left",label:"Ended At",prop:"end_date"}),s(d,{align:"left",label:"Duration",prop:"start_date"},{default:u(l=>[k(x(D(P)(l.row.end_date).diff(D(P)(l.row.start_date),"days")),1)]),_:1}),s(d,{label:"Review",align:"center",prop:"rate"},{default:u(l=>[t("a",{class:"btn btn-primary col-md-6",onClick: B=>O(l.row.id),href:"#"},[k(x(l.row.rate)+" ",1),Ne],8,Ae)]),_:1}),s(d,{align:"right"},{header:u(()=>[s(Y,{modelValue:h.value,"onUpdate:modelValue":e[11]||(e[11]= l=>h.value=l),size:"small",placeholder:"Type to search"},null,8,["modelValue"])]),_:1})]),_:1},8,["data","loading"])])])])}}};export{gl as default};
