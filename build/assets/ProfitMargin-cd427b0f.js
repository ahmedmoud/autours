import"./base-40151e19.js";import{E as G,a as H}from "./el-table-column-d728468a.js";import"./el-checkbox-8f2d8563.js";import"./el-tooltip-fe7a3ae3.js";import"./el-scrollbar-4d76fa87.js";import{E as J}from "./el-input-5a2c3fae.js";/* empty css               *//* empty css                  */import{r as s,k as K,o as Q,a as p,c as x,b as a,w as R,d as r,l as i,f as D,v as L,F as E,m as N,q as S,j as P,t as X}from "./app-417fc4a4.js";import{d as B}from "./index-5c14bedf.js";/* empty css                    */import{E as Y,a as Z}from "./index-7afdeace.js";import"./objects-a3f7d715.js";import"./_initCloneObject-5d6a36d4.js";import"./isArrayLikeObject-38992b29.js";import"./_baseIteratee-ab40514f.js";import"./flatten-66fc93b5.js";import"./typescript-8048a034.js";import"./index-e7076969.js";import"./scroll-b0cd01fe.js";import"./validator-3cef17f7.js";const ee={class:"card"},le={class:"card-body"},oe=a("h2",{class:"mb-4"},"Profit Margins",-1),ae={class:"card"},te={class:"card-body"},se={class:""},re={class:"row"},ne={class:"formbold-mb-3 col-md-2"},ie=a("label",{class:"formbold-form-label"},"Country",-1),de={class:"formbold-mb-3 col-md-2"},ue=a("label",{class:"formbold-form-label"},"Suppliers",-1),pe={class:"formbold-mb-3 col-md-2"},ce=a("label",{class:"formbold-form-label"},"Branches",-1),me={class:"formbold-mb-3 col-md-2"},ve=a("label",{class:"formbold-form-label"},"Vehicles",-1),_e={class:"d-flex",style:{gap:"10px"}},fe=["src"],he=a("hr",null,null,-1),be=a("h4",null,"Profit Percentage",-1),ye={class:"row mt-5"},ge={class:"formbold-mb-3 col-md-2"},we=a("label",{class:"formbold-form-label"},"1-2 Day",-1),Ve={class:"input-with-percent"},ke=a("span",{class:"percent-symbol"},"%",-1),xe={class:"formbold-mb-3 col-md-2"},Pe=a("label",{class:"formbold-form-label"},"3 - 7 Days",-1),Ce={class:"input-with-percent"},Te=a("span",{class:"percent-symbol"},"%",-1),Ue={class:"formbold-mb-3 col-md-2"},qe=a("label",{class:"formbold-form-label"},"8-30 Days",-1),$e={class:"input-with-percent"},De=a("span",{class:"percent-symbol"},"%",-1),Le={class:"formbold-mb-3 col-md-2"},Ee=a("label",{class:"formbold-form-label"},"Weekend",-1),Ne={class:"input-with-percent"},Se=a("span",{class:"percent-symbol"},"%",-1),Be=a("div",{class:"text-center"},[a("button",{type:"submit",class:"formbold-btn"},"Submit")],-1),ze={class:"card"},Me={class:"card-body"},Ae=["src"],Fe={class:"btn"},je=["onClick"],ul={__name:"ProfitMargin",setup(Ie){const C=s(!1),b=s(""),t=s([]),y=s(""),T=s(""),U=s(""),q=s("");s(""),s(!0);const d=s(""),c=s(""),g=s(""),m=s(""),f={loading:s(!1),all:s([]),list:s([]),options:s([])},h={loading:s(!1),all:s([]),list:s([]),options:s([])},w={loading:s(!1),all:s([]),list:s([]),options:s([])},V={loading:s(!1),all:s([]),list:s([]),options:s([])},$=async o=>{try{C.value=!0;const e={};d.value&&(e.country=d.value),c.value&&(e.supplier=c.value),m.value&&(e.branch=m.value),g.value&&(e.selectedVehicles=g.value),console.log(m.value);const n=await axios.get("/get/profit",{params:e});t.value=n.data.data;for(const v in t.value[o])data.value[v]=t.value[o][v]||""}catch(e){console.error(e)}finally{C.value=!1}},z=K(()=>{const o=Array.isArray(t.value)?t.value:[];return console.log("here"),o.filter(e=>!b.value||!d.value||e.vehicle_name&&e.vehicle_name.toLowerCase().includes(b.value.toLowerCase())||e.vehicle_name&&e.vehicle_name.toLowerCase().includes(d.value.toLowerCase())||e.branch_name&&e.branch_name.toLowerCase().includes(b.value.toLowerCase())||e.branch_country&&e.branch_country.toLowerCase().includes(b.value.toLowerCase()))}),M=async()=>{const o=new FormData,e=B.useToast();if(y.value&&y.value>0&&!isNaN(y.value))o.append("priceTax",y.value);else{e.error("1-2 days profit is required and should be more than 0",{position:"top"});return}if(T.value)o.append("weekPriceTax",T.value);else{e.error("3-7 days profit is required and should be more than 0",{position:"top"});return}if(U.value)o.append("monthPriceTax",U.value);else{e.error("8 - 30 days profit is required and should be more than 0",{position:"top"});return}if(q.value)o.append("weekendPriceTax",q.value);else{e.error("weekend profit is required and should be more than 0",{position:"top"});return}if(d.value)o.append("country",d.value);else{e.error("Please select country",{position:"top"});return}c.value&&o.append("supplier",c.value),m.value&&o.append("branch",m.value),g.value.length>0&&o.append("selectedVehicles",g.value);try{await axios.post("profit/upload",o),e.success("Price List updated",{position:"top"})}catch(n){e.error(n.message,{position:"top"})}finally{$()}},A=async()=>{f.loading.value=!0;try{const o=await axios.get("/get/countries",{});f.all.value=o.data,console.log(o),f.list.value=f.all.value.map(e=>({id:`${e}`,label:`${e}`,iso:`${e}`}))}catch(o){console.error(o)}finally{f.loading.value=!1}},F=async o=>{try{C.value=!0;const e=new FormData,n=B.useToast();if(t.value[o].per_day_profit&&!isNaN(t.value[o].per_day_profit)&&t.value[o].per_day_profit>0)e.append("priceTax",t.value[o].per_day_profit);else{n.error("1-2 days profit is required and should be more than 0 for "+t.value[o].vehicle_name,{position:"top"});return}if(t.value[o].per_week_profit)e.append("weekPriceTax",t.value[o].per_week_profit);else{n.error("3-7 days profit is required and should be more than 0 for "+t.value[o].vehicle_name,{position:"top"});return}if(t.value[o].per_month_profit)e.append("monthPriceTax",t.value[o].per_month_profit);else{n.error("8 - 30 days profit is required and should be more than 0 for "+t.value[o].vehicle_name,{position:"top"});return}if(t.value[o].weekend_profit)e.append("weekendPriceTax",t.value[o].weekend_profit);else{n.error("weekend profit is required and should be more than 0 for "+t.value[o].vehicle_name,{position:"top"});return}e.append("selectedVehicles",t.value[o].vehicle_id);const v=await axios.post("profit/upload",e);n.success("Price List updated successfully to "+t.value[o].vehicle_name,{position:"top"})}catch(e){console.error(e)}finally{$()}},j=async()=>{try{if(h.loading.value=!0,d.value){const o=await axios.get("get/suppliers",{params:{country:d.value}});h.all.value=o.data,h.list.value=h.all.value.map(e=>({value:`${e.name}`,label:`${e.name}`,id:`${e.id}`}))}}catch(o){console.error(o)}finally{h.loading.value=!1}},I=async()=>{try{const o=await axios.get("get/branches",{params:{company_id:c.value}});w.all.value=o.data,w.list.value=w.all.value.map(e=>({value:`${e.name}`,label:`${e.name}`,id:`${e.id}`}))}catch(o){console.error(o)}},O=async()=>{try{const o=await axios.get("get/vehicles",{params:{branch_id:m.value,supplier:c.value}});V.all.value=o.data,V.list.value=V.all.value.map(e=>({value:`${e.name}`,label:`${e.name}`,id:`${e.id}`,photo:`${e.photo}`}))}catch(o){console.error(o)}};return Q(()=>{$(),A()}),(o, e)=>{const n=Z,v=Y,u=H,k=J,W=G;return p(),x("div",ee,[a("div",le,[oe,a("div",ae,[a("div",te,[a("div",se,[a("form",{onSubmit:R(M,["prevent"])},[a("div",re,[a("div",ne,[ie,r(v,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]= l=>d.value=l),size:"large",filterable:"",remote:"","reserve-keyword":"",placeholder:"Countries...","remote-show-suffix":"",loading:f.loading.value,onChange:e[1]||(e[1]= l=>j()),required:""},{default:i(()=>[(p(!0),x(E,null,N(f.list.value, l=>(p(),S(n,{key:l.id,label:l.label,value:l.label},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),a("div",de,[ue,r(v,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]= l=>c.value=l),size:"large",filterable:"",remote:"","reserve-keyword":"",onChange:e[3]||(e[3]= l=>I()),placeholder:"Suppliers...","remote-show-suffix":"",loading:h.loading.value,required:""},{default:i(()=>[(p(!0),x(E,null,N(h.list.value, l=>(p(),S(n,{key:l.id,label:l.label,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),a("div",pe,[ce,r(v,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]= l=>m.value=l),size:"large",filterable:"",remote:"","reserve-keyword":"",onChange:e[5]||(e[5]= l=>O()),placeholder:"Branches...","remote-show-suffix":"",loading:w.loading.value,required:""},{default:i(()=>[(p(!0),x(E,null,N(w.list.value, l=>(p(),S(n,{key:l.id,label:l.label,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),a("div",me,[ve,r(v,{modelValue:g.value,"onUpdate:modelValue":e[6]||(e[6]= l=>g.value=l),size:"large",filterable:"",remote:"",multiple:"","reserve-keyword":"",placeholder:"Vehicles...","remote-show-suffix":"",loading:V.loading.value,required:""},{default:i(()=>[(p(!0),x(E,null,N(V.list.value, l=>(p(),S(n,{key:l.id,label:l.label,value:l.id},{default:i(()=>[a("div",_e,[a("img",{src:"img/vehicles/"+l.photo,style:{width:"50px"}},null,8,fe),P(" "+X(l.label),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),a("div",{class:"mt-4 col-md-1"},[a("button",{class:"mt-2 btn btn-primary col-md-12",type:"button",onClick:$},"Search")])]),he,be,a("div",ye,[a("div",ge,[we,a("div",Ve,[D(a("input",{"onUpdate:modelValue":e[7]||(e[7]= l=>y.value=l),type:"text",pattern:"[0-9]+([,.][0-9]+)?",class:"formbold-form-input"},null,512),[[L,y.value]]),ke])]),a("div",xe,[Pe,a("div",Ce,[D(a("input",{"onUpdate:modelValue":e[8]||(e[8]= l=>T.value=l),type:"text",pattern:"[0-9]+([,.][0-9]+)?",class:"formbold-form-input"},null,512),[[L,T.value]]),Te])]),a("div",Ue,[qe,a("div",$e,[D(a("input",{"onUpdate:modelValue":e[9]||(e[9]= l=>U.value=l),type:"text",pattern:"[0-9]+([,.][0-9]+)?",class:"formbold-form-input"},null,512),[[L,U.value]]),De])]),a("div",Le,[Ee,a("div",Ne,[D(a("input",{"onUpdate:modelValue":e[10]||(e[10]= l=>q.value=l),type:"text",pattern:"[0-9]+([,.][0-9]+)?",class:"formbold-form-input"},null,512),[[L,q.value]]),Se])]),Be])],32)])])]),a("div",ze,[a("div",Me,[r(W,{data:z.value,style:{width:"100%"},loading:C.value,stripe:""},{default:i(()=>[r(u,{label:"Photo",prop:""},{default:i(l=>[a("img",{src:"/img/vehicles/"+l.row.photo,width:"150",height:"100"},null,8,Ae)]),_:1}),r(u,{label:"Vehicle Name",prop:"vehicle_name"}),r(u,{label:"Country",prop:"branch_country"}),r(u,{label:"Branch Name",prop:"branch_name"}),r(u,{label:"1-2 days Price",prop:"per_day_profit"},{default:i(l=>[r(k,{class:"col-6",modelValue:t.value[l.$index].per_day_profit,"onUpdate:modelValue": _=>t.value[l.$index].per_day_profit=_,value:l.row.per_day_profit,placeholder:"1-2 price"},null,8,["modelValue","onUpdate:modelValue","value"]),P(" % ")]),_:1}),r(u,{label:"3-7 days Price",prop:"per_week_profit"},{default:i(l=>[r(k,{class:"col-6",modelValue:t.value[l.$index].per_week_profit,"onUpdate:modelValue": _=>t.value[l.$index].per_week_profit=_,value:l.row.per_week_profit,placeholder:"3-7 price"},null,8,["modelValue","onUpdate:modelValue","value"]),P(" % ")]),_:1}),r(u,{label:"4-30 days Price",prop:"per_month_profit"},{default:i(l=>[r(k,{class:"col-6",modelValue:t.value[l.$index].per_month_profit,"onUpdate:modelValue": _=>t.value[l.$index].per_month_profit=_,value:l.row.per_month_profit,placeholder:"4-30 price"},null,8,["modelValue","onUpdate:modelValue","value"]),P(" % ")]),_:1}),r(u,{label:"weekend Price",prop:"per_month_profit"},{default:i(l=>[r(k,{class:"col-6",modelValue:t.value[l.$index].weekend_profit,"onUpdate:modelValue": _=>t.value[l.$index].weekend_profit=_,value:l.row.weekend_profit,placeholder:"4-30 price"},null,8,["modelValue","onUpdate:modelValue","value"]),P(" % ")]),_:1}),r(u,{label:"Actions"},{default:i(l=>[a("button",Fe,[a("i",{style:{color:"green"},onClick: _=>F(l.$index),class:"fa fa-check fa-2x"},null,8,je)])]),header:i(()=>[r(k,{modelValue:b.value,"onUpdate:modelValue":e[11]||(e[11]= l=>b.value=l),size:"large",placeholder:"Type to search"},null,8,["modelValue"])]),_:1})]),_:1},8,["data","loading"])])])])])}}};export{ul as default};
